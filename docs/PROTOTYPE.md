# V4Corner 网页原型设计

本文档描述了 V4Corner 项目的网页原型，包含用户登录和博客功能的完整页面设计。

---

## 设计原则

基于当前项目的简洁风格：
- **配色**：白色卡片 + 浅灰渐变背景（`#f8fafc` → `#e2e8f0`）
- **字体**：Inter / system-ui，现代无衬线字体
- **布局**：最大宽度 960px 居中，响应式设计
- **交互**：简洁的导航栏，清晰的视觉层次

---

## 页面结构

### 1. 导航栏（全局）

**当前状态**：
```
[V4Corner] [Home] [Blogs] [About]
```

**更新后**：
```
[V4Corner] [首页] [博客] [成员] [AI对话] 💬

未登录时显示：[登录] [注册]
已登录时显示：[头像/用户名] ▼ 点击显示下拉菜单
  - 我的博客
  - 个人中心
  - 退出登录
```

**交互说明**：
- 点击[AI对话]跳转到AI对话列表页（需要登录）
- 点击头像/用户名显示下拉菜单
- 未登录时点击博客详情页的"编辑"/"删除"，跳转到登录页并提示"请先登录"
- 未登录时点击[AI对话]，跳转到登录页并提示"请先登录后使用AI对话功能"

---

## 2. 登录页面 `/login`

### 页面布局

```
┌─────────────────────────────────────┐
│          [V4Corner]                 │
│                                     │
│     ┌─────────────────────────┐    │
│     │      登录到 V4Corner    │    │
│     ├─────────────────────────┤    │
│     │                         │    │
│     │  [用户名或邮箱]          │    │
│     │                         │    │
│     │  [密码]                  │    │
│     │                         │    │
│     │  [ ] 记住我              │    │
│     │                         │    │
│     │  [   登   录   ]         │    │
│     │                         │    │
│     │  还没有账号？[立即注册]   │    │
│     │                         │    │
│     └─────────────────────────┘    │
│                                     │
└─────────────────────────────────────┘
```

### 字段说明

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| username_or_email | string | 是 | 用户名或邮箱地址 |
| password | string | 是 | 密码（加密传输） |
| remember_me | boolean | 否 | 记住登录状态（7天） |

### 样式规格
- 登录框宽度：400px
- 居中显示
- 白色卡片，带阴影
- 输入框高度：44px
- 按钮高度：48px
- 按钮背景色：`#0f172a`（深色）
- 按钮文字：白色
- 错误提示：输入框下方红色文字

### API 调用
- 成功后保存 JWT Token 到 localStorage
- 跳转到之前访问的页面或首页

---

## 3. 注册页面 `/register`

### 页面布局

```
┌─────────────────────────────────────┐
│          [V4Corner]                 │
│                                     │
│     ┌─────────────────────────┐    │
│     │      注册 V4Corner      │    │
│     ├─────────────────────────┤    │
│     │                         │    │
│     │  [用户名]               │    │
│     │    3-20个字符            │    │
│     │                         │    │
│     │  [邮箱]                 │    │
│     │                         │    │
│     │  [密码]                 │    │
│     │    至少6个字符            │    │
│     │                         │    │
│     │  [确认密码]             │    │
│     │                         │    │
│     │  [昵称]（可选）         │    │
│     │                         │    │
│     │  [   注   册   ]         │    │
│     │                         │    │
│     │  已有账号？[立即登录]     │    │
│     │                         │    │
│     └─────────────────────────┘    │
│                                     │
└─────────────────────────────────────┘
```

### 字段说明

| 字段 | 类型 | 必填 | 验证规则 |
|------|------|------|----------|
| username | string | 是 | 3-20字符，字母数字下划线，唯一 |
| email | string | 是 | 邮箱格式，唯一 |
| password | string | 是 | 6-20字符 |
| password_confirm | string | 是 | 与 password 一致 |
| nickname | string | 否 | 2-20字符 |

### 交互说明
- 输入时实时验证（失去焦点时）
- 用户名/邮箱重复时提示
- 两次密码不一致时提示
- 注册成功后自动登录

---

## 4. 首页 `/`（改进）

### 当前状态
简单的欢迎文字

### 改进后布局

```
┌─────────────────────────────────────┐
│ [V4Corner] [首页] [博客] [成员] ...  │
├─────────────────────────────────────┤
│                                     │
│  欢迎来到 V4Corner                   │
│  行健-车辆4班的班级空间              │
│                                     │
│  ┌─────────────────────────────┐   │
│  │  班级通知                    │   │
│  ├─────────────────────────────┤   │
│  │  · 期中答辩时间调整...         │   │
│  │  · 周五班会地点变更...         │   │
│  │  · 实验室值班表更新...         │   │
│  └─────────────────────────────┘   │
│                                     │
│  ┌─────────────────────────────┐   │
│  │  班级日历                    │   │
│  ├─────────────────────────────┤   │
│  │  日历网格（本月）              │   │
│  │  12  13  14  15  16  17  18  │   │
│  │          [活动]     [活动]    │   │
│  └─────────────────────────────┘   │
│                                     │
│  ┌─────────────────────────────┐   │
│  │  博客推送（按时间）            │   │
│  ├─────────────────────────────┤   │
│  │  2025-01-10 机器学习入门      │   │
│  │  2025-01-09 数据结构与算法    │   │
│  │  2025-01-08 项目实践总结      │   │
│  └─────────────────────────────┘   │
│                                     │
│  [查看更多博客 →]                   │
│                                     │
└─────────────────────────────────────┘
```

### 内容说明
- **Hero 区域**：欢迎语 + 简短介绍
- **班级通知**：顶部列表区，展示最新 3-5 条通知
- **班级日历**：月视图日历，带活动标记与悬浮提示
- **博客推送**：按时间倒序的简洁列表，可点击跳转详情

---

## 5. 博客列表页 `/blogs`（改进）

### 当前状态
简单的网格布局，显示博客卡片

### 改进后布局

```
┌─────────────────────────────────────┐
│ [V4Corner] [首页] [博客] [成员] ...  │
├─────────────────────────────────────┤
│                                     │
│  博客                     [写博客]  │
│  ───────────────────────────────    │
│                                     │
│  筛选：[全部] [我的博客]            │
│                                     │
│  ┌─────────────────────────────┐   │
│  │ 博客标题              [详情] │   │
│  │ 张三 · 2025-01-10               │   │
│  │                                 │   │
│  │ 这是博客摘要，显示前150个字...   │   │
│  └─────────────────────────────┘   │
│                                     │
│  ┌─────────────────────────────┐   │
│  │ 另一篇博客            [详情] │   │
│  │ 李四 · 2025-01-09               │   │
│  │                                 │   │
│  │ 这是另一篇博客的摘要...          │   │
│  └─────────────────────────────┘   │
│                                     │
│  [加载更多]                         │
│                                     │
└─────────────────────────────────────┘
```

### 功能说明
- **写博客按钮**：已登录用户可见，点击跳转到创建博客页面
- **筛选**：未登录时只显示"全部"，已登录时显示"全部"和"我的博客"
- **博客卡片**：
  - 标题（可点击跳转到详情）
  - 作者 + 发布时间
  - 摘要（内容前150字）
  - "详情"按钮（右侧）
- **分页**：每页显示 10 篇，底部"加载更多"按钮

---

## 6. 博客详情页 `/blogs/:id`（新增，参考博客园风格）

### 页面布局

```
┌─────────────────────────────────────┐
│ [V4Corner] [首页] [博客] [成员] ...  │
├─────────────────────────────────────┤
│                                     │
│  博客首页 > [博客标题]               │
│                                     │
│  ┌─────────────────────────────┐   │
│  │                             │   │
│  │  博客标题                     │   │
│  │  ───────────────────────     │   │
│  │                             │   │
│  │  作者：张三                   │   │
│  │  发布时间：2025-01-10 08:30  │   │
│  │  阅读次数：128                │   │
│  │                             │   │
│  │  [编辑] [删除]  ← 仅作者可见 │   │
│  │                             │   │
│  ├─────────────────────────────┤   │
│  │                             │   │
│  │  博客正文内容...              │   │
│  │                             │   │
│  │  这是博客的完整内容，支持：  │   │
│  │  - 段落                      │   │
│  │  - 标题（H1, H2, H3...）     │   │
│  │  - 代码块（语法高亮）        │   │
│  │  - 图片                      │   │
│  │  - 链接                      │   │
│  │  - 列表                      │   │
│  │                             │   │
│  │  正文内容继续...              │   │
│  │                             │   │
│  └─────────────────────────────┘   │
│                                     │
│  ┌─────────────────────────────┐   │
│  │  评论区（计划功能）          │   │
│  ├─────────────────────────────┤   │
│  │  [暂无评论]                  │   │
│  └─────────────────────────────┘   │
│                                     │
└─────────────────────────────────────┘
```

### 设计说明（参考博客园）

**博客标题区域**：
- 大标题（H1）
- 下方分隔线
- 元信息区域：
  - 作者：[作者名]（可点击跳转到用户个人中心）
  - 发布时间：YYYY-MM-DD HH:MM
  - 阅读次数：自动统计
- 操作按钮（仅作者可见）：
  - [编辑]：跳转到编辑页面
  - [删除]：弹出确认对话框

**正文内容区域**：
- 白色卡片容器
- 内容宽度适配（最大 800px）
- 支持 Markdown 渲染：
  - 标题层级（H1-H6）
  - 代码块（带语法高亮）
  - 图片（支持上传，自动缩放）
  - 引用块
  - 列表（有序/无序）
  - 表格
  - 链接
- 字体大小：16px（正文）
- 行高：1.8
- 段落间距：1em

**评论区域**（计划功能）：
- 已登录用户可发表评论
- 显示所有评论（按时间倒序）
- 评论作者可删除自己的评论

### 交互说明
- 点击博客标题可返回顶部
- 点击作者名跳转到作者的个人中心
- 点击"编辑"跳转到编辑页面（`/blogs/:id/edit`）
- 点击"删除"弹出确认对话框，确认后调用删除 API
- 删除成功后跳转到博客列表页

---

## 7. 创建博客页面 `/blogs/new`（新增）

### 页面布局

```
┌─────────────────────────────────────┐
│ [V4Corner] [首页] [博客] [成员] ...  │
├─────────────────────────────────────┤
│                                     │
│  [← 返回]          创建新博客        │
│  ───────────────────────────────    │
│                                     │
│  ┌─────────────────────────────┐   │
│  │  标题                        │   │
│  │  [________________]          │   │
│  │                             │   │
│  │  内容（支持 Markdown）       │   │
│  │  ┌─────────────────────┐    │   │
│  │  │                     │    │   │
│  │  │  Markdown 编辑器    │    │   │
│  │  │                     │    │   │
│  │  │                     │    │   │
│  │  └─────────────────────┘    │   │
│  │                             │   │
│  │  [预览]                      │   │
│  │                             │   │
│  │  [取消]              [发布] │   │
│  └─────────────────────────────┘   │
│                                     │
└─────────────────────────────────────┘
```

### 字段说明

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| title | string | 是 | 1-200字符 |
| content | string | 是 | Markdown 格式 |

### 功能说明
- **标题输入框**：单行文本，最多200字符
- **内容编辑器**：
  - 简单文本域（初期）
  - 后期可考虑集成 Markdown 编辑器（如 toast-ui/editor）
  - 支持 Markdown 语法提示
- **预览功能**：
  - 点击"预览"按钮，显示渲染后的效果
  - 可以在编辑和预览之间切换
- **操作按钮**：
  - [取消]：返回上一页或博客列表
  - [发布]：提交内容，成功后跳转到博客详情页

### 样式规格
- 编辑框宽度：100%
- 内容编辑器高度：400px
- 预览区域与编辑器等高
- 按钮右对齐

---

## 8. 编辑博客页面 `/blogs/:id/edit`（新增）

### 页面布局

与创建博客页面相同，区别在于：
- 标题：`编辑博客`
- 表单预填充：当前博客的标题和内容
- 操作按钮：
  - [取消]：返回博客详情页
  - [保存]：提交修改，成功后跳转到博客详情页

### 权限控制
- 只有博客作者可以编辑
- 非作者访问显示 403 错误页面

---

## 9. 用户个人中心 `/users/:id`（新增）

### 页面布局

```
┌─────────────────────────────────────┐
│ [V4Corner] [首页] [博客] [成员] ...  │
├─────────────────────────────────────┤
│                                     │
│  ┌─────────────────────────────┐   │
│  │  ┌─────┐  张三              │   │
│  │  │头像 │  @zhangsan         │   │
│  │  └─────┘                    │   │
│  │                             │   │
│  │  车辆4班 · 清华大学          │   │
│  │                             │   │
│  │  [编辑资料] ← 仅本人可见     │   │
│  └─────────────────────────────┘   │
│                                     │
│  个人简介：                          │
│  这是张三的个人简介...              │
│                                     │
│  ┌─────────────────────────────┐   │
│  │  统计信息                    │   │
│  ├─────────────────────────────┤   │
│  │  发布博客：15 篇             │   │
│  │  注册时间：2024-09-01        │   │
│  └─────────────────────────────┘   │
│                                     │
│  ┌─────────────────────────────┐   │
│  │  TA 的博客                   │   │
│  ├─────────────────────────────┤   │
│  │  · 机器学习入门              │   │
│  │  · 项目实践总结              │   │
│  │  · 数据结构与算法            │   │
│  └─────────────────────────────┘   │
│                                     │
└─────────────────────────────────────┘
```

### 信息说明

**用户基本信息**：
- 头像：默认头像或自定义（80x80px，圆形）
- 昵称：显示昵称或用户名
- 用户名：@username
- 班级/学校（可选）：自由填写
- 个人简介（可选）：最多200字

**统计信息**：
- 发布博客数：自动统计
- 注册时间：YYYY-MM-DD

**TA 的博客列表**：
- 显示该用户发布的所有博客（最多显示 10 篇）
- 按发布时间倒序
- 点击跳转到博客详情

### 交互说明
- 点击"编辑资料"（仅本人可见），弹出编辑对话框
- 编辑资料可修改：昵称、班级/学校、个人简介、头像

---

## 10. 成员列表页 `/members`（新增）

### 页面布局

```
┌─────────────────────────────────────┐
│ [V4Corner] [首页] [博客] [成员] ...  │
├─────────────────────────────────────┤
│                                     │
│  班级成员                            │
│  ───────────────────────────────    │
│                                     │
│  搜索：[______________]             │
│                                     │
│  ┌────┐  张三          @zhangsan   │
│  │头像│  车辆4班 · 15篇博客           │
│  └────┘  [查看详情 →]              │
│                                     │
│  ┌────┐  李四          @lisi       │
│  │头像│  车辆4班 · 8篇博客            │
│  └────┘  [查看详情 →]              │
│                                     │
│  ┌────┐  王五          @wangwu     │
│  │头像│  车辆4班 · 12篇博客           │
│  └────┘  [查看详情 →]              │
│                                     │
└─────────────────────────────────────┘
```

### 功能说明
- **搜索**：按用户名或昵称搜索（实时过滤）
- **成员列表**：
  - 头像（40x40px，圆形）
  - 昵称/用户名
  - 班级 + 博客数
  - "查看详情"按钮，点击跳转到个人中心
- **排序**：按注册时间或博客数排序（后期功能）

---

## 11. 编辑资料对话框（弹出）

### 触发方式
在个人中心点击"编辑资料"按钮

### 页面布局

```
┌─────────────────────────────────┐
│  编辑资料                    [X]│
├─────────────────────────────────┤
│                                 │
│  ┌─────┐                        │
│  │头像 │  [更换头像]             │
│  └─────┘                        │
│                                 │
│  昵称                            │
│  [__________________]           │
│                                 │
│  班级/学校                       │
│  [__________________]           │
│                                 │
│  个人简介                        │
│  ┌─────────────────────┐        │
│  │                     │        │
│  │  最多200字          │        │
│  │                     │        │
│  └─────────────────────┘        │
│                                 │
│  [取消]              [保存]     │
│                                 │
└─────────────────────────────────┘
```

### 字段说明

| 字段 | 类型 | 必填 | 说明 |
|------|------|------|------|
| nickname | string | 否 | 2-20字符 |
| class | string | 否 | 班级或学校名称 |
| bio | string | 否 | 最多200字 |
| avatar | file | 否 | 图片文件，最大2MB |

### 功能说明
- 头像上传：点击"更换头像"按钮，选择本地图片文件
- 表单验证：失去焦点时验证
- 保存成功后关闭对话框，刷新页面数据

---

## 全局样式规范

### 颜色系统
```css
主色调：#0f172a（深蓝灰）
次要色：#475569（中灰）
背景色：#f8fafc（浅灰）→ #e2e8f0（渐变）
卡片背景：#ffffff（白色）
边框色：#e2e8f0（浅灰边框）
链接色：#0f172a
错误色：#ef4444（红色）
成功色：#10b981（绿色）
```

### 字体系统
```css
字体：Inter / system-ui / -apple-system / sans-serif
标题大小：
  H1: 32px / 1.2（博客详情页标题）
  H2: 24px / 1.3
  H3: 20px / 1.4
正文字体：16px / 1.8（行高）
小字：14px / 1.5
```

### 间距系统
```css
卡片内边距：1rem（16px）
卡片间距：1rem（16px）
页面左右边距：1.5rem（24px）
页面顶部边距：2rem（32px）
```

### 阴影
```css
卡片阴影：0 2px 8px rgba(15, 23, 42, 0.06)
导航栏阴影：0 2px 6px rgba(15, 23, 42, 0.04)
悬浮阴影：0 4px 12px rgba(15, 23, 42, 0.12)
```

---

## 响应式设计

### 断点
- **移动端**：< 768px
- **平板**：768px - 1024px
- **桌面**：> 1024px

### 移动端适配
- 导航栏：折叠为菜单按钮
- 博客列表：单列布局
- 博客详情：内容宽度自适应
- 表单：输入框宽度100%

---

## 交互反馈

### 加载状态
- 按钮点击后显示 loading 状态（禁用 + 旋转图标）
- 页面加载时显示骨架屏或 loading 文字

### 错误提示
- 表单验证错误：输入框下方红色文字
- API 错误：顶部 Toast 提示（3秒自动消失）
- 404/403 页面：友好的错误提示页面

### 成功提示
- 操作成功后：顶部 Toast 提示（绿色，2秒自动消失）
- 创建/编辑博客成功：跳转到详情页

---

## 数据模型需求

基于以上原型设计，需要的数据模型：

### User（用户）
```typescript
{
  id: number;
  username: string;        // 用户名（唯一，登录用）
  email: string;           // 邮箱（唯一）
  password_hash: string;   // 密码哈希（不返回给前端）
  nickname: string;        // 昵称（显示用）
  avatar_url: string;      // 头像URL
  class: string;           // 班级/学校
  bio: string;             // 个人简介
  created_at: string;      // 注册时间
}
```

### Blog（博客）
```typescript
{
  id: number;
  title: string;           // 标题
  content: string;         // Markdown内容
  author_id: number;       // 作者ID
  author_name: string;     // 作者名（冗余，方便查询）
  views: number;           // 阅读次数
  created_at: string;      // 创建时间
  updated_at: string;      // 更新时间
}
```

---

## 12. AI对话列表页 `/chat`（新增）

### 页面布局

```
┌─────────────────────────────────────┐
│ [V4Corner] [首页] [博客] [成员] [AI对话] 💬 │
├─────────────────────────────────────┤
│                                     │
│  AI对话                    [+ 新对话]│
│  ───────────────────────────────    │
│                                     │
│  搜索对话：[______________]         │
│                                     │
│  ┌─────────────────────────────┐   │
│  │  💬 机器学习入门指南         │   │
│  │     最后消息：如何理解梯度... │   │
│  │     2025-01-15 14:30        │   │
│  ├─────────────────────────────┤   │
│  │  💬 Python代码调试帮助       │   │
│  │     最后消息：感谢你的帮助！  │   │
│  │     2025-01-14 09:15        │   │
│  ├─────────────────────────────┤   │
│  │  💬 项目架构设计讨论         │   │
│  │     最后消息：我觉得可以...  │   │
│  │     2025-01-12 16:45        │   │
│  └─────────────────────────────┘   │
│                                     │
└─────────────────────────────────────┘
```

### 功能说明

**页面结构**：
- 顶部：标题 + [新对话] 按钮
- 搜索栏：实时过滤对话列表
- 对话列表：按最近更新时间倒序排列

**对话卡片显示**：
- 对话标题（用户首次输入或自动生成）
- 最后一条消息预览（最多50字，超出省略）
- 最后更新时间（相对时间：刚刚、2小时前、昨天等）

**操作功能**：
- [新对话]：点击创建新的对话，跳转到对话详情页
- 点击对话卡片：进入该对话的详情页
- 长按/右键对话卡片：显示删除选项（弹出确认对话框）

### 权限控制
- 需要登录才能访问
- 只显示当前用户自己的对话历史

### 样式规格
- 页面最大宽度：960px，居中
- 对话卡片高度：80px
- 卡片间距：12px
- 悬浮效果：浅灰背景 + 轻微阴影

---

## 13. AI对话详情页 `/chat/:id`（新增，参考ChatGPT风格）

### 页面布局

```
┌─────────────────────────────────────────────────────────┐
│ [V4Corner] [首页] [博客] [成员] [AI对话] 💬              │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  [← 返回]        机器学习入门指南              [⋮]      │
│  ───────────────────────────────────────────────────   │
│                                                         │
│  ┌─────────────────────────────────────────────────┐  │
│  │  👤 用户 · 刚刚                                  │  │
│  │  ─────────────────────────────────────────────  │  │
│  │  请帮我解释一下什么是梯度下降算法？              │  │
│  │                                                  │  │
│  └─────────────────────────────────────────────────┘  │
│                                                         │
│  ┌─────────────────────────────────────────────────┐  │
│  │  🤖 AI · 刚刚                                   │  │
│  │  ─────────────────────────────────────────────  │  │
│  │  梯度下降是一种优化算法，主要用于最小化损失函数。 │  │
│  │                                                  │  │
│  │  **基本原理：**                                  │  │
│  │  1. 从一个初始点开始                             │  │
│  │  2. 计算该点的梯度（斜率）                        │  │
│  │  3. 沿梯度的反方向移动一小步                      │  │
│  │  4. 重复步骤2-3，直到达到最小值                  │  │
│  │                                                  │  │
│  │  **形象比喻：**                                  │  │
│  │  想象你在山上，想要下山到最低点。梯度下降就像是   │  │
│  │  每次都往脚下的最陡方向迈一步，最终你会到达山谷。  │  │
│  │                                                  │  │
│  │  [📋 复制] [👍 有帮助] [👎 无帮助]               │  │
│  └─────────────────────────────────────────────────┘  │
│                                                         │
│  ┌─────────────────────────────────────────────────┐  │
│  │  👤 用户 · 2分钟前                              │  │
│  │  ─────────────────────────────────────────────  │  │
│  │  能用一个简单的代码示例说明吗？                  │  │
│  │                                                  │  │
│  └─────────────────────────────────────────────────┘  │
│                                                         │
│  ┌─────────────────────────────────────────────────┐  │
│  │  🤖 AI · 2分钟前                                │  │
│  │  ─────────────────────────────────────────────  │  │
│  │  当然！这是一个简单的Python示例：                │  │
│  │                                                  │  │
│  │  ```python                                      │  │
│  │  def gradient_descent():                         │  │
│  │      x = 10  # 初始位置                          │  │
│  │      learning_rate = 0.1  # 学习率              │  │
│  │      for i in range(100):                       │  │
│  │          gradient = 2 * x  # 导数               │  │
│  │          x = x - learning_rate * gradient       │  │
│  │      return x                                    │  │
│  │  ```                                            │  │
│  │                                                  │  │
│  │  [📋 复制] [👍 有帮助] [👎 无帮助]               │  │
│  └─────────────────────────────────────────────────┘  │
│                                                         │
│  ○ 停止生成                                            │
│                                                         │
│  ┌─────────────────────────────────────────────────┐  │
│  │  [输入消息给AI...]                  [发送] 📤    │  │
│  │                                                  │  │
│  └─────────────────────────────────────────────────┘  │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

### 设计说明（参考ChatGPT风格）

#### **整体布局**
- **全屏对话界面**：最大化对话内容显示区域
- **中央内容区**：最大宽度 768px，居中显示
- **消息流式布局**：从上到下按时间顺序排列，最新消息在底部
- **自动滚动**：新消息出现时自动滚动到底部

#### **消息气泡设计**

**用户消息**：
- 背景色：`#0f172a`（深色）
- 文字：白色
- 对齐：右对齐
- 最大宽度：70%
- 内边距：12px 16px
- 圆角：12px

**AI消息**：
- 背景色：`#f1f5f9`（浅灰）
- 文字：`#0f172a`（深色）
- 对齐：左对齐
- 最大宽度：85%
- 内边距：16px
- 圆角：12px
- 支持Markdown渲染（代码块、列表、加粗等）

#### **消息头部信息**
- 用户名：👤 用户 / 🤖 AI
- 时间：相对时间（刚刚、2分钟前、1小时前等）
- 字体：12px，灰色

#### **AI消息操作按钮**（悬浮显示）
- 📋 复制：复制消息内容到剪贴板
- 👍 有帮助：标记为有帮助（反馈）
- 👎 无帮助：标记为无帮助（反馈）
- 按钮仅在鼠标悬浮时显示，保持界面简洁

#### **输入区域**
- 位置：固定在页面底部
- 输入框：多行文本输入，支持自动扩展高度
- 占位符：`输入消息给AI...`
- 发送按钮：右侧，蓝色背景
- 快捷键：Enter 发送，Shift+Enter 换行

#### **状态显示**
- **AI生成中**：显示"○ 停止生成"按钮
- **停止按钮**：点击后中断AI回复
- **流式输出**：AI回复逐字显示（打字机效果）

### 交互功能

#### **消息交互**
1. **发送消息**：
   - 输入消息后按Enter或点击发送按钮
   - 消息立即显示在对话中（乐观更新）
   - 输入框清空，焦点保持

2. **AI回复**：
   - 显示"AI正在思考..."加载状态
   - 流式输出：逐字显示AI回复
   - 自动滚动到最新消息

3. **停止生成**：
   - AI回复时显示"停止生成"按钮
   - 点击后立即停止输出
   - 已生成部分保留显示

4. **重新生成**：
   - AI回复后显示"重新生成"按钮
   - 点击后重新生成最后一条AI消息

#### **对话管理**
- **标题菜单**（点击右上角[⋮]）：
  - 重命名对话
  - 导出对话（Markdown格式）
  - 删除对话（弹出确认对话框）

- **返回按钮**：点击返回对话列表页

#### **快捷操作**
- 复制消息：点击复制按钮，显示"已复制"提示
- 代码块：点击代码块右上角复制按钮
- 滚动到底部：点击新消息提示（当用户滚动向上查看历史时显示）

### 响应式设计

#### **桌面端**（>1024px）
- 消息最大宽度：用户 70%，AI 85%
- 左右留白：居中显示

#### **平板端**（768px-1024px）
- 消息最大宽度：用户 75%，AI 90%
- 减小左右留白

#### **移动端**（<768px）
- 消息最大宽度：85%
- 全宽输入框
- 隐藏部分操作按钮（保留核心功能）
- 触摸优化的按钮尺寸（最小44px）

### 样式规格

#### **颜色系统**
```css
用户消息背景：#0f172a
AI消息背景：#f1f5f9
页面背景：#ffffff
输入框背景：#ffffff
输入框边框：#e2e8f0
输入框聚焦边框：#0f172a
发送按钮：#0f172a
文字颜色：#0f172a
次要文字：#64748b
```

#### **字体**
```css
消息内容：16px / 1.6（行高）
代码块：14px（Monaco, Consolas, monospace）
时间戳：12px
```

#### **间距**
```css
消息间距：24px
消息内边距：12px 16px（用户）/ 16px（AI）
页面底部留白：120px（为输入框留空间）
```

#### **动画**
```css
消息出现：fade in + slide up（0.3s）
AI打字效果：逐字显示
按钮悬浮：scale(1.05)（0.2s）
```

### 特殊功能

#### **代码高亮**
- 代码块自动语法高亮（使用highlight.js或类似库）
- 支持语言：Python, JavaScript, TypeScript, Java, C++, Go, Rust等
- 显示语言标签
- 一键复制代码块

#### **Markdown渲染**
支持完整的Markdown语法：
- 标题（H1-H6）
- 加粗、斜体
- 列表（有序、无序）
- 代码块（带语法高亮）
- 引用块
- 表格
- 链接
- 图片

#### **上下文管理**
- 显示当前对话的Token使用情况（可选）
- 超长对话自动截取最近N条消息（避免超出上下文限制）
- 提示用户"此对话过长，建议新建对话"

### 错误处理

#### **网络错误**
- 显示"网络连接失败，请检查网络设置"
- 提供"重试"按钮
- 本地保存用户消息（暂存）

#### **API错误**
- 显示"AI服务暂时不可用，请稍后重试"
- 错误消息以红色提示显示

#### **超时**
- 30秒无响应显示"请求超时"
- 提供"重新发送"选项

---

## 14. 新建对话流程

### 创建新对话

**触发方式**：
1. 在AI对话列表页点击[+ 新对话]按钮
2. 在对话详情页点击[新建对话]

**流程**：
1. 自动创建新的对话记录
2. 跳转到对话详情页（`/chat/{new_id}`）
3. 显示欢迎消息：
   ```
   🤖 AI · 刚刚
   ─────────────────────────────────────────────
   你好！我是V4Corner的AI助手。

   我可以帮助你：
   - 解答学习问题
   - 代码调试和优化
   - 项目建议和思路讨论
   - 文档和资料查询

   有什么我可以帮助你的吗？
   ```

**自动命名**：
- 用户发送第一条消息后，自动生成对话标题
- 标题生成规则：提取前30字作为标题
- 用户可以在菜单中手动重命名

---

## 数据模型需求（AI对话功能）

### Conversation（对话）
```typescript
{
  id: number;
  user_id: number;         // 用户ID（外键）
  title: string;           // 对话标题
  created_at: string;      // 创建时间
  updated_at: string;      // 最后更新时间
}
```

### Message（消息）
```typescript
{
  id: number;
  conversation_id: number; // 对话ID（外键）
  role: 'user' | 'assistant'; // 角色
  content: string;         // 消息内容（支持Markdown）
  created_at: string;      // 发送时间
  tokens_used?: number;    // 使用的Token数（可选）
}
```

---

## 下一步

完成原型确认后，进入**API 接口设计**阶段：

1. 根据原型确定所有需要的 API 端点
2. 定义每个接口的请求/响应格式
3. 编写完整的 API 文档（更新 `docs/API.md`）
4. 前后端团队基于 API 文档并行开发
